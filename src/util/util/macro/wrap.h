#pragma once

#include <util/macro/arg_count.h>
#include <util/macro/token_paste.h>

#define WRAP0(PRE, SUF, X) PRE##SUF
#define WRAP1(PRE, SUF, X) PRE##X##SUF
#define WRAP2(PRE, SUF, X1, X2) WRAP1(PRE, SUF, X1) WRAP1(PRE, SUF, X2)
#define WRAP3(PRE, SUF, X1, X2, X3) WRAP2(PRE, SUF, X1, X2) WRAP1(PRE, SUF, X3)
#define WRAP4(PRE, SUF, X1, X2, X3, X4) WRAP3(PRE, SUF, X1, X2, X3) WRAP1(PRE, SUF, X4)
#define WRAP5(PRE, SUF, X1, X2, X3, X4, X5) WRAP4(PRE, SUF, X1, X2, X3, X4) WRAP1(PRE, SUF, X5)
#define WRAP6(PRE, SUF, X1, X2, X3, X4, X5, X6) WRAP5(PRE, SUF, X1, X2, X3, X4, X5) WRAP1(PRE, SUF, X6)
#define WRAP7(PRE, SUF, X1, X2, X3, X4, X5, X6, X7) WRAP6(PRE, SUF, X1, X2, X3, X4, X5, X6) WRAP1(PRE, SUF, X7)
#define WRAP8(PRE, SUF, X1, X2, X3, X4, X5, X6, X7, X8) WRAP7(PRE, SUF, X1, X2, X3, X4, X5, X6, X7) WRAP1(PRE, SUF, X8)
#define WRAP9(PRE, SUF, X1, X2, X3, X4, X5, X6, X7, X8, X9) WRAP8(PRE, SUF, X1, X2, X3, X4, X5, X6, X7, X8) WRAP1(PRE, SUF, X9)

#define WRAP(PRE, SUF, ...) TOKEN_PASTE_INDIRECT(WRAP, GET_ARG_COUNT(__VA_ARGS__))(PRE, SUF, __VA_ARGS__)


#define WRAP_CALL0(MACRO, X)
#define WRAP_CALL1(MACRO, X) MACRO(X)
#define WRAP_CALL2(MACRO, X1, X2) WRAP_CALL1(MACRO, X1) WRAP_CALL1(MACRO, X2)
#define WRAP_CALL3(MACRO, X1, X2, X3) WRAP_CALL2(MACRO, X1, X2) WRAP_CALL1(MACRO, X3)
#define WRAP_CALL4(MACRO, X1, X2, X3, X4) WRAP_CALL3(MACRO, X1, X2, X3) WRAP_CALL1(MACRO, X4)
#define WRAP_CALL5(MACRO, X1, X2, X3, X4, X5) WRAP_CALL4(MACRO, X1, X2, X3, X4) WRAP_CALL1(MACRO, X5)
#define WRAP_CALL6(MACRO, X1, X2, X3, X4, X5, X6) WRAP_CALL5(MACRO, X1, X2, X3, X4, X5) WRAP_CALL1(MACRO, X6)
#define WRAP_CALL7(MACRO, X1, X2, X3, X4, X5, X6, X7) WRAP_CALL6(MACRO, X1, X2, X3, X4, X5, X6) WRAP_CALL1(MACRO, X7)
#define WRAP_CALL8(MACRO, X1, X2, X3, X4, X5, X6, X7, X8) WRAP_CALL7(MACRO, X1, X2, X3, X4, X5, X6, X7) WRAP_CALL1(MACRO, X8)
#define WRAP_CALL9(MACRO, X1, X2, X3, X4, X5, X6, X7, X8, X9) WRAP_CALL8(MACRO, X1, X2, X3, X4, X5, X6, X7, X8) WRAP_CALL1(MACRO, X9)

#define WRAP_CALL(MACRO, ...) TOKEN_PASTE_INDIRECT(WRAP_CALL, GET_ARG_COUNT(__VA_ARGS__))(MACRO, __VA_ARGS__)